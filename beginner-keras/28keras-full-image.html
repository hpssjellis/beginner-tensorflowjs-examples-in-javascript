
<!--   *******************************Start: What source js file to use? ****************************************************   -->


<!-- the online version that these examples were made with  -->

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.4"></script>





<!-- the newest version script tag is below but by using it all the examples may not work 

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

-->



<!-- Or you could download the newest version, save it as myNewDownloadedTensorflow.js and use the link below and work completely offline using a tag similar to


<script src="myNewDownloadedTensorflow.js"></script>

-->

 <!-- Note: often nice to load the readable version of the src file. Remember to match the numbers to whatever the newest version is.

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.4/dist/tf.js"></script>

--> 



<!--   *******************************Stop: What source js file to use? ****************************************************   -->



    
    
<h2 align=center>Convolutional Keras Layers Full Image Neural Network.</h2>






<div style="font-size:15px; background-color:lightyellow; width:88%;  border:5px solid blue; padding:5px; margin:5px;"> 
Keras Image and Video Convolutional Layer Neural Network.<br><br>
So I tried real simple text based image analysis, but the reality is that images are 24 bit rgb style and Tensorflowjs
 with it's floating point math can handle the larger amount of data. <br><br>

 So lets try to do something similar to the last page and train the model with full images loaded from this web domain
 
 DRAFT MODE
</div><br>


 
 
 


<div id="myDiv7979Code"> 
 
 
 Test page for loading multiple images of different sizes, force them to 32 x 32, and then load the data into a tensor as the xTrainingData for a Neural Network.<br> (Labels would have to be dealt with using a coordinated text file!)<br><br>

<textarea id="myURLs" rows=16 cols=140>
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-0.jpg,
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-1.jpg,  
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-3.jpg,
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-4.jpg,

https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-5.jpg,
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-6.jpg,  
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/random/ran3.png,
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/random/ran4.jpg


  
  
  
  
</textarea>
<br>

<input type=button value="load Images" onclick="myLoadImage()">

<input type=button value="Data to Tensor (Check console) " onclick="{
  myFinalMakeTensor()
}"><br>
 
 
 

Test or change this data <br>
<textarea id="myAsk2" rows=4 cols=100 wrap=false>https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/ball02.png</textarea><br>
<input id="myButton7979" type="button" value="Train images and test" onclick="{ 
                                                                                    
document.getElementById('myButton7979').style.backgroundColor = 'red' 

                                                                             
                                                                              
                                                                              
                                                                              
//const xs = tf.tensor4d([ ], shape=[8, 32, 32, 1] );    // 8 input images that are 32 x 32 with  10 colors 0-9)                                                                                                                                                     
                                                                                                                                                                        
// Labels of how many lines in each image. I can make much more images just few here for simplicity                                                                     
const ys = tf.tensor2d([0,1,0,0,    0,1,0,0,    0,1,0,0,    0,1,0,0,    0,1,0,0,    0,1,0,0,    1,0,0,0,   1,0,0,0 ], shape=[8, 4]);        // 8 images 4 dimension                                                                                                                  
                                                                                                                                                                        
                                                                                                                                                                        
model = tf.sequential();                                                                                                                                          
                                                                                                                                                                        
model.add(tf.layers.conv2d({                                                                                                                                            
    inputShape: [32, 32, 3],                                                                                                                                                  
    kernelSize: 2,                                                                                                                                                          
    filters: 4,                                                                                                                                                             
    strides: 8,                                                                                                                                                             
    activation: 'relu',                                                                                                                                                     
    kernelInitializer: 'varianceScaling'                                                                                                                                    
}));                                                                                                                                                                    
                                                                                                                                                                        
model.add(tf.layers.conv2d({ kernelSize: 2, filters: 4, strides: 8, activation: 'relu', kernelInitializer: 'varianceScaling' }));                                       
                                                                                                                                                                        
model.add(tf.layers.flatten());                                                                                                                                         
model.add(tf.layers.dense({ units: 30, kernelInitializer: 'varianceScaling', activation: 'softmax' }));                                                                 
model.add(tf.layers.dense({ units: 4, activation: 'linear' }) ); 
                                          
model.compile({optimizer: 'sgd', loss: 'meanSquaredError'});   
                                                                              
//document.getElementById('myButton7979').style.backgroundColor = 'red'   
                                                                              
(async function() { // inline async so we can use promises and await                                                                                                   
                                                                                                                                                                        
                                                                                                                   
    var myFit = await model.fit(xs, ys, { 
      batchSize: 8192, 
      epochs : 700, 
      callbacks :  {  
                                                                              
          onBatchEnd: async (batch, logs) => {                                                               
              await tf.nextFrame();  // This improves UI responsiveness during training.  
          },       
                                                                              
         onEpochEnd: async (epoch, logs) => {                                            
              document.getElementById('myDiv7979').innerHTML = 'Loss after Epoch ' + epoch + '/700 : ' + logs.loss +' <br><br>'                                                               
         }   
                                                                              
      }  // end all callbacks                                                                        
    });  // end model.fit                                                                                                              
    
  await document.getElementById('myButtonTest').click() 
  document.getElementById('myButton7979').style.backgroundColor = 'yellow'                                                                               
})()
                                                                                                                                                                      

                                                                                                                                                                       
}" > 
 
<input  type="button" id="myButtonTest" value="Re-Test" onclick="{  
  (async function () {  
    
  //mySingleLoad = async function(myFileName2, newX, newY, loop) {                                                               
                                                                 
    const myTestTensor = await myTestLoad(document.getElementById('myAsk2').value) 
                                                                 
    const myPredictArray = await model.predict(myTestTensor).data()       
    //const myPredictArray = await model.predict(tf.tensor4d(myTestDataArray, [1, 32, 32, 3])).data()                                                                                                                                      
   // document.getElementById('myDiv7979').innerHTML = 'Input '+document.getElementById('myAsk2').value+'<br><br> Output = <br>'                                                                                                                                    
    document.getElementById('myDiv7979').innerHTML  = 'Output = <br>'
    document.getElementById('myDiv7979').innerHTML += '<b>No Shape ' + await Math.round(myPredictArray[0]*100) +'%</b><br>'          
    document.getElementById('myDiv7979').innerHTML += '<b>Circle ' + await Math.round(myPredictArray[1]*100) +'%</b><br>'        
    document.getElementById('myDiv7979').innerHTML += '<b>Triangle ' + await Math.round(myPredictArray[2]*100) +'%</b><br>'        
    document.getElementById('myDiv7979').innerHTML += '<b>Rectangle ' + await Math.round(myPredictArray[3]*100) +'%</b><br>'    
              
                                                             
 })()   // end the inline async function
}" >
 
 
 Reshaped image --> <canvas id="myReshapeCanvas" width="32" height="32" style="border: 1px solid #ddd; "></canvas> <br> 
 
 
<br> All images below fixed 100 x 100 and pixelated if low resolution<br>
 
<br><canvas id="myCanvas" style="background-color:lightgray;" width="1000" height="101" style="border: 1px solid #ddd; image-rendering: pixelated; interpolation-mode: nearest-neighbor;"></canvas> <br>




 <!-- ************* Next we define the Javascript inside a web element so that the page can be refreshed dynamically **************-->
 
 <!--  ************* The entire next line can be replaced with the <script> tag for a more conventional approch. ****************** -->

<style id="myButton124"  onload="{document.getElementById('myButton124').click()}"  onclick="{
                                                                                             
                                                                                             
                                                                                             
                                                                                             
   
                                                                                             
                                                                                             
                                                                                             
  ////////////////////////////////////////// START LOAD IMAGE ///////////////////////////////////////////////////////////

///////////////////// As soon as you start using real images the coding gets much more complex
///////////////////// Mainly becuase each pixel of colour is 4 data points Red, Green, Blue and Alpha
///////////////////// Where Alpha is the amount of transparency

myTestDataArray = []                                                                                             
                                                                                             
myMainData = []; // stores imageData as an array
//mySpecial = 0; // count loops for when a new row is needed
myShape = [];
myNewCanvasHeight = 101

myFinalMakeTensor = async function() {
  //console.log(myMainData)
  // var energy = myMainData.join();
  var myNewArray4 = myMainData.join().split(','); // trick to flatten the array
  // console.log(myNewArray4);

  var canvasReshape = document.getElementById('myReshapeCanvas');

  const myMainTensor = tf.tensor4d(myNewArray4,(shape = [myMainData.length, canvasReshape.width, canvasReshape.height, 4]),'int32');
 // xs = tf.tensor4d(myNewArray4,(shape = [myMainData.length, canvasReshape.width, canvasReshape.height, 4]),'int32');

  // document.getElementById('myTensorArea').value =   JSON.stringify(myMainTensor.dataSync() , null, 3)

  //document.getElementById('myTensorArea').value =   myMainTensor.dataSync()
 // console.log('Before Change')                                                                                           
 // myMainTensor.print(true);
                                                                                             
xs = myMainTensor.slice([0, 0, 0, 0], [-1, -1, -1, 3]);                                                                                           
  
  myMainTensor.dispose()
 // console.log('After Change')  
                                                                                             
 // xs.print(true);                                                                                           
                                                                                             
  myMainData.length = 0;
  myMainData = [];
};

myMultiLoad = async function(myImageArray) {
  let newX2 = 0;
  let newY2 = 0;
  let myRows = 0;
  let myLoopStore = 0;
  for (var myLoop = 0; myLoop <= myImageArray.length - 1; myLoop++) {
    if (myLoop % 10 == 0 && myLoop != 0) {
      myRows += 101;
      myLoopStore = myLoop;
      newY2 = myRows;
      myNewCanvasHeight = myRows                                                                                       
    }
    //console.log(myImageArray[myLoop])
    //newX2 = ((myLoop - myLoopStore)*100) + myLoop
    newX2 = (myLoop - myLoopStore) * 101;
    //console.log(newX2+ ', '+ newY2)
    mySingleLoad(myImageArray[myLoop], newX2, newY2, myLoop);
  }
};
mySingleLoad = async function(myFileName2, newX, newY, loop) {
  if (myFileName2 != null) {
    var img = new Image();
    img.src = myFileName2;
    img.crossOrigin = 'Anonymous';

    var canvasReshape = document.getElementById('myReshapeCanvas'); // 32 x 32
    var ctxReshape = canvasReshape.getContext('2d');

    var canvas = document.getElementById('myCanvas'); // 1000 x 1000
    var ctx = canvas.getContext('2d');
    canvas.height = myNewCanvasHeight + 101
                                                                                             
                                                                                             
    ////////////////////////////////////////  trick to make the image pixelated when scaled   //////////////////////////////////
    ctx.imageSmoothingEnabled = false;
    ctx.webkitImageSmoothingEnabled = false;
    ctx.mozImageSmoothingEnabled = false;
    ctx.msImageSmoothingEnabled = false;
    ctx.oImageSmoothingEnabled = false;

    img.onload = function() {
      //document.getElementById('myX').value  += '\n\n'
      ctxReshape.drawImage(img,0,0,img.width,img.height,0,0,canvasReshape.width,canvasReshape.height);

      //console.log('canvasReshape.width: '+canvasReshape.width)

      var imageData = ctxReshape.getImageData(0,0,canvasReshape.width,canvasReshape.height);

      //myMainData[loop] =  imageData;
      console.log(imageData);
      var data = imageData.data;
      myMainData[loop] = data;

      const latestTensor = tf.fromPixels(imageData, 4);
      // not sure how to drop the alpha channel so I just included it

      // tf.stack([myMainTensor, latestTensor]);
      // wow = tf.concat3d([myMainTensor , latestTensor])
      // myMainTensor.concat3d(latestTensor)

      latestTensor.print(true);
      document.getElementById('myDiv7979').innerHTML = latestTensor.dataSync()                                                                                       
      myShape = latestTensor.shape;
      console.log('myShape: ' + myShape);

      /*
    
    // to force black and white images
    
    for (var i = 0; i < data.length; i += 4) {
      var avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
      data[i]     = avg; // red
      data[i + 1] = avg; // green
     data[i + 2] = avg; // blue
     
    }  // end for loop
   // console.log(data) 
     */

      // ctx.rect(newX,newY,newX+100,newY+100);
      // ctx.stroke();

      // ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, newX, newY, 100, 100);
      // img.style.display = 'none';
      // img.style.display = 'inline';
    };
  }
};

myLoadImage = async function() {
  // const myFileName = prompt('Enter the URL of your stored data', 'https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/t4png.png, https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/t5png.png, https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/t6png.png, https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/t7png.png');
  //const myFileNameArray =   myFileName.split(',')
  const myFileNameArray = document.getElementById('myURLs').value.split(',');

  //if (myFileNameArray.length >= 2 ){

  myMultiLoad(myFileNameArray);

  //} else {
  // mySingleLoad(myFileName, 0, 0, mySpecial)
  //         mySpecial += 1

  //} // end if  null
};

                                                                                             
                                                                                             
                                                                                             
 myTestLoad = async function(myFileName3) {
  if (myFileName3 != null) {
    var img = new Image();
    img.src = myFileName3;
    img.crossOrigin = 'Anonymous';

    var canvasReshape = document.getElementById('myReshapeCanvas'); // 32 x 32
    var ctxReshape = canvasReshape.getContext('2d');


                                                                                             
                                                                                             


    img.onload = function() {

      ctxReshape.drawImage(img,0,0,img.width,img.height,0,0,canvasReshape.width,canvasReshape.height);

      console.log('canvasReshape.width: '+canvasReshape.width)

      var imageData = ctxReshape.getImageData(0,0,canvasReshape.width,canvasReshape.height);


      console.log(imageData);
      var data = imageData.data;
     // myMainData[loop] = data;

      latestTensor = tf.fromPixels(imageData, 3);     // this time get rid of the alpha component
      // not sure how to drop the alpha channel so I just included it

      // tf.stack([myMainTensor, latestTensor]);
      // wow = tf.concat3d([myMainTensor , latestTensor])
      // myMainTensor.concat3d(latestTensor)

     // latestTensor.print(true);
     // document.getElementById('myDiv7979').innerHTML = latestTensor.dataSync()                                                                                       
     // const myShape = latestTensor.shape;
    //  console.log('myShape: ' + myShape);



    //  ctx.drawImage(img, newX, newY, 100, 100);
      // img.style.display = 'none';
      // img.style.display = 'inline';
    };
  }
                                                                                          
 return latestTensor                                                                                            
                                                                                             
};                                                                                            
                                                                                             
                                                                                             
                                                                                             
////////////////////////////////////////// END LOAD IMAGE ///////////////////////////////////////////////////////////
                                                                                           
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
}"></style>
<!-- If you replaced the <style> tag with a <script> tag don't forget to change the above line to just </script>  -->
                                                                 



                                                                                             
                                                                                             
                                                                                             


 
 
 
 
 
 
 
 
 
</div>
<div id='myDiv7979'>...</div><br>



<input id="myUpdate7979" type=button value="Update and Run" style="visibility:hidden;" onclick="{

   // first remove first and last line since they are injected
  myFred = document.getElementById('myTextarea7979').value.split('\n')
  myFred.pop()
  myFred.push('')
  myFred.shift()
  myFred.shift()
  myJoe = myFred.join('\n')

  document.getElementById('myDiv7979Code').innerHTML =    myJoe 
  document.getElementById('myButton7979').click()
                                             
}"><br>


<textarea id="myTextarea7979"  wrap="off"  style= "font-size:15px; color:white; background-color:black; width:90%;"   rows=2 onclick="{
  if (myOnce7979){
     myTextGrow('myTextarea7979', 'myDiv7979Code')
     document.getElementById('myUpdate7979').style.visibility = 'visible'
     myOnce7979 = false
  }
}">
Click here to see the working HTML code.
</textarea><br>







<br><br><br><hr><br><br><br><br>











<div style="font-size:15px; background-color:lightyellow; width:88%;  border:5px solid blue; padding:5px; margin:5px;"> 
Now lets try the above in a full Machine Learning Web App
 
</div><br>

<div id="myDiv124Code"> 
 <!-- ********************************************   Web page elements here *********************************** -->
 
 

<h2 align=center> Tensorflowjs Machine Learning Web App Template</h2>
<h5 align=center>As simple as possible template. Note that for simplicity this has minimal CSS</h5>

<h3>Pre-Set Values:</h3>
<table border=1 >
  <tr><td>Model Width: </td><td><input id="myModelWidth" type=text value=32 title="Change before Compiling Model" placeholder="32"></td></tr>
  <tr><td>Model Height: </td><td><input id="myModelHeight" type=text value=32 title="Change before Compiling Model" placeholder="32"></td></tr>
  <tr><td>Learning Rate: </td><td><input id="myLearn" type=text value=0.2 title="From about 0.5 to 0.0001" placeholder="0.2"></td></tr>
  <tr><td>Samples per batch:</td><td><input id="myBatch" type=number value=8192  title="Batch = Number of samples to run together" placeholder="8192"></td></tr>
  <tr><td>Epochs: (# of batches to run)</td><td><input id="myEpoch" type=number  title="Epoch = number of batches to train" value=1400 placeholder="1400"></td></tr>
 <tr><td>Validation Split :</td><td><input id="myValidationSplit" type=text  title="Validation Split = percent of data to test in decimal form 0.15 = use 15% to test" value=0.00 placeholder="200"></td></tr></table><br><br><br>




<h3>Data: Data cannot begin or end with a comma!</h3>
<table border=1>
 <tr><td>Multi-image load data and labels</td><td><textarea id="myMultiURL" rows=10 cols=120 NOWRAP placeholder="">
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-1.jpg,  
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-3.jpg,
https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-4.jpg
</textarea></td><td>
  All images must be CORS (Cross-Origin Resource Sharing) compatible. Easiest solution is to put the images on the 
  same website as this webpage.<br>
  <select id="mySelectMultiTarget" onChange="{'selecting ['+this.value+'] for all the images to load'}">
   <option value=",1,0,0,0"> No Shape
   <option value=",0,1,0,0" selected="selected"> Circle
   <option value=",0,0,1,0"> Triangle
   <option value=",0,0,0,1"> Rectangle
  </select>
  <input id="myButtonMultiLoad" type="button" value="Multi Add Image and Labels" onclick="{ 
   myMultiLoadImage()                                                                             
}"></td></tr>
 
 
  <tr><td>xTrainingData:</td><td><textarea id="myX" rows=100 cols=120 NOWRAP placeholder="">
                                                                                                                                                                           
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0
,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0
,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0
,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0
,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0
,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0
,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0
,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0
,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0
,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0
,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0
,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0
,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0                                                                                                                                                              

   
   
   
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0                                                                                                                                                                

   
   
   
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0
,0,0,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0
,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0
,0,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0,0
,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0
,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0
,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0
,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0
,0,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0
,0,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0,0
,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0
,0,0,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0
,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0    

   
   
   
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,8,8,9,9,8,8,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,0,0,0,0,8,9,8,8,0,0,0,0,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,0,0,0,0,9,0,9,9,0,9,0,9,9,0,9,0,0,0,9,9,9,9,9,9,9
,9,9,9,9,9,9,0,0,9,0,0,0,0,9,9,9,0,9,9,9,0,9,9,0,0,0,0,9,9,9,9,9
,9,9,9,9,9,0,0,0,9,0,9,0,0,9,9,0,0,9,9,9,0,0,9,9,9,0,0,9,9,9,9,9
,9,9,9,9,9,0,0,9,9,0,8,0,0,9,0,0,0,0,0,0,9,8,9,9,0,0,0,9,9,9,9,9
,9,9,9,9,9,0,0,1,9,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,9,9,9,9,9
,9,9,9,9,9,0,0,9,9,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9
,9,9,9,9,9,0,0,9,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,9,9,1,9,9
,9,9,9,9,8,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,9,9,9,9,9
,9,9,9,9,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,1,9
,9,9,9,0,9,1,9,9,0,0,9,9,9,9,0,0,9,9,9,9,9,9,0,9,9,1,1,1,0,9,1,9
,9,0,9,0,1,1,9,9,9,0,0,9,9,9,9,0,0,9,9,1,9,9,0,9,1,1,1,1,1,9,9,9
,9,9,8,9,1,1,1,1,9,9,0,9,9,9,9,9,9,9,9,9,9,9,0,9,1,1,1,1,9,9,1,9
,9,9,0,9,9,9,1,1,9,9,0,9,9,9,9,9,9,9,9,9,9,0,9,9,1,1,9,9,9,9,1,9
,9,9,0,9,9,9,9,9,1,9,0,0,9,9,1,9,9,9,9,9,9,0,9,9,9,9,9,9,9,0,1,9
,9,9,9,9,9,9,9,9,9,9,8,0,1,9,1,9,9,1,1,9,9,0,9,9,9,9,9,9,9,8,1,9
,9,9,9,0,0,9,9,9,9,9,9,0,9,1,9,9,9,1,1,1,0,9,9,9,9,9,9,8,9,1,1,9
,9,9,9,9,0,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,8,9,9,1,1,9
,9,9,9,9,8,9,8,0,0,0,0,0,0,9,1,9,1,1,1,1,0,0,1,0,8,0,8,9,9,1,9,9
,9,9,9,9,9,1,9,0,0,9,0,0,9,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,9,9
,9,9,9,9,9,1,1,0,9,0,0,9,1,1,1,1,1,1,1,1,1,9,0,0,0,9,1,1,1,9,9,9
,9,9,9,9,9,9,1,1,1,1,0,9,9,9,9,9,9,9,9,9,9,9,1,9,9,1,9,1,1,9,9,9
,9,9,9,9,9,9,9,1,1,1,0,9,9,9,9,9,9,9,9,9,9,9,9,9,1,9,1,1,9,9,9,9
,9,9,9,9,9,9,9,1,1,1,1,0,0,8,9,9,9,9,8,8,0,8,1,1,9,1,1,9,9,9,9,9
,9,9,9,9,9,9,9,9,1,9,1,1,0,9,9,9,9,9,9,9,9,1,1,1,1,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,1,1,9,0,0,0,0,0,0,9,9,9,1,1,1,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9  
 
   
   
   
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,8,9,8,9,9,9,9,9,9,9,9,9,9,9,9,1
,9,9,9,9,9,9,9,9,9,8,9,9,9,9,9,0,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,9,9,8,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,9,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8
,9,9,9,9,9,9,9,9,9,9,9,9,9,1,1,1,9,9,9,1,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,0,0,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,9,1,1,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,8,0,0,9,1,9,9,9,9,1,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,9,0,0,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,0,0,0,0,8,0,0,0,0,0,0,9,9,9,9,9,1,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,0,0,0,0,8,8,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,8,0,0,9,0,0,0,0,0,8,8,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,8,9,0,0,0,9,9,9,9,9,1,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,8,8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
 
   
   
   
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,0,0
,0,0,0,0,8,0,0,0,0,0,0,0,9,9,0,1,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,0,9,0,0,0,0,0,0,9,9,9,0,0,0,9,9,0,0,0,0,0
,0,0,0,0,0,0,9,0,0,9,0,0,9,9,9,0,9,1,9,9,0,0,0,0,0,0,1,9,9,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,9,0,0,9,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,9,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,8,0,0
,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0
,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,9,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,9,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,1,0,8,9,0,0,0,0,0,0,0,0,0,0,0
,0,0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0
,0,0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,9,0,0,9,8,8,0,0,0,0,0,0,9,9,0,0
,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0,9,9,0,0,0,0
,0,0,0,0,9,9,0,0,0,0,0,1,0,0,0,0,9,9,9,9,9,9,9,9,9,0,0,0,9,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,9,9,9,9,9,9,9,9,0,0,0,9,9,0,0,0
,0,0,0,0,0,0,0,0,0,8,0,0,8,0,0,0,0,9,9,9,9,9,9,1,0,0,8,9,0,0,0,0
,0,0,0,0,0,0,0,9,9,0,9,9,9,0,0,9,0,0,9,9,9,1,0,0,9,9,9,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,8,0,0,0,0,8,1,9,9,0,0,0,0,0
,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,8,9,9,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,0,0,0,0,0,0,0,8,8,9,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,8,0,8,8,8,8,8,9,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,9,9,9,8,9,9,8,8,8,8,9,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0  
 
   
   
   
,0,0,9,0,1,0,0,0,0,9,1,9,9,0,9,9,9,8,9,9,8,9,0,9,9,9,1,1,0,0,0,9
,1,9,0,0,0,8,0,9,9,0,8,1,9,9,9,9,9,9,9,9,9,8,0,0,9,9,8,8,9,9,9,0
,9,9,0,9,0,0,9,9,9,1,1,9,1,9,0,0,9,9,9,9,9,1,0,9,9,9,0,0,0,9,0,0
,8,9,0,0,9,0,0,9,0,1,8,0,1,9,9,1,9,9,9,9,0,9,9,9,9,9,9,8,9,0,9,9
,0,9,8,8,8,0,9,0,9,0,9,9,0,9,0,0,8,9,8,0,9,0,0,0,9,9,0,1,0,9,9,9
,0,0,9,0,8,1,0,0,9,9,0,9,1,9,0,0,1,9,0,0,1,1,0,9,9,9,0,9,1,9,0,9
,9,9,1,1,9,8,9,9,1,1,9,0,0,0,9,1,9,9,9,1,9,1,9,9,9,9,0,9,1,1,0,0
,1,9,1,8,0,0,9,9,9,8,0,9,0,0,9,9,9,9,9,0,0,1,9,1,9,0,0,1,9,0,0,0
,9,9,9,0,0,0,9,0,9,9,9,9,0,0,8,0,0,1,0,9,1,9,0,9,9,0,1,8,9,0,9,0
,9,9,1,9,0,0,0,9,9,9,9,9,0,0,9,9,9,0,9,9,0,9,0,0,9,0,1,0,1,0,9,9
,0,9,0,9,9,1,9,1,0,0,0,0,9,0,9,9,0,1,9,0,9,9,1,0,9,0,1,9,1,9,9,9
,9,9,0,1,9,9,9,9,9,0,9,9,1,9,9,1,9,1,9,0,1,9,9,9,9,0,9,1,0,9,9,9
,8,0,9,1,0,1,9,1,9,0,9,9,1,0,0,0,9,1,0,9,9,0,9,0,0,9,0,9,9,9,9,0
,0,0,0,1,9,9,9,9,9,9,9,9,9,9,9,8,9,9,9,9,9,1,0,9,9,9,0,9,0,0,0,0
,0,9,1,0,8,9,9,9,9,9,9,8,0,9,9,1,9,0,9,0,1,9,9,9,9,9,9,9,0,9,9,9
,9,9,9,1,8,9,9,9,9,9,0,0,9,8,1,0,0,0,9,9,0,9,9,0,9,9,9,9,9,0,0,1
,9,9,9,9,9,8,0,0,9,9,9,8,9,0,1,0,0,9,9,9,1,1,9,9,9,9,1,9,9,1,9,0
,1,9,9,9,1,1,1,9,0,9,9,9,8,9,9,9,0,0,0,0,9,9,1,9,9,9,9,0,1,9,0,9
,0,0,0,9,9,1,9,1,0,0,9,1,0,0,8,9,9,9,0,0,1,9,9,8,9,9,1,0,1,9,0,9
,0,0,9,9,9,0,0,9,8,9,9,0,0,9,1,9,9,0,1,9,9,9,9,0,8,9,9,0,0,1,1,0
,0,0,0,1,9,0,0,0,9,0,0,0,8,9,9,8,0,0,9,8,0,0,9,0,9,0,0,9,9,0,0,0
,1,1,9,9,9,9,9,9,9,9,0,9,9,0,9,9,9,0,0,9,0,0,8,0,1,0,0,8,0,0,0,0
,1,9,0,9,9,9,0,1,9,9,9,9,0,9,9,9,9,1,8,0,9,8,9,9,9,0,0,9,9,9,0,0
,0,9,0,9,9,0,0,0,9,1,9,9,0,0,9,9,0,9,9,9,0,1,9,0,8,9,1,1,0,1,0,0
,9,0,0,9,9,0,9,9,9,9,9,0,9,0,8,8,9,0,8,0,9,0,0,9,9,8,9,9,9,0,9,9
,9,1,9,9,9,9,0,0,9,9,9,0,0,9,0,0,9,9,9,0,9,0,0,9,9,9,9,9,9,1,9,9
,9,9,0,0,1,9,9,9,9,9,9,9,9,0,0,8,9,9,9,9,9,9,8,9,9,0,0,9,9,1,9,1
,9,9,1,9,9,9,9,9,9,1,0,9,9,8,9,9,9,9,9,1,1,9,9,1,9,9,9,1,9,9,9,8
,0,9,9,0,9,9,9,9,9,9,1,9,0,0,9,9,9,1,9,9,9,1,9,9,0,9,0,1,9,9,9,1
,9,9,0,9,9,8,9,9,9,9,9,9,9,0,9,0,9,9,9,0,9,9,9,9,8,1,0,9,9,9,9,9
,0,9,9,9,0,9,1,0,0,1,9,1,8,0,1,9,9,1,9,1,9,0,9,8,9,9,0,9,0,9,8,9
,0,9,9,9,9,9,9,0,0,9,0,0,8,9,9,9,9,9,8,9,9,9,9,9,9,9,9,0,8,9,0,9 

   
   
,1,1,1,1,1,9,9,1,1,1,9,1,1,9,9,9,9,1,9,1,9,1,1,1,9,9,9,1,9,9,1,1
,1,1,1,1,1,9,1,9,1,1,9,1,9,1,9,9,1,9,9,1,1,1,1,9,9,1,9,1,1,1,9,1
,1,9,1,1,1,9,1,1,1,9,1,1,9,9,1,1,1,9,9,9,9,9,9,9,9,1,1,1,1,9,1,9
,9,1,9,1,1,1,9,9,9,9,9,1,9,1,9,1,9,9,1,9,9,9,1,9,9,9,9,9,9,9,1,1
,9,9,9,9,1,9,9,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,9,9,1,1
,9,9,1,1,9,9,9,9,1,9,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,9,9,9,9,9
,9,9,1,9,9,9,9,9,9,9,9,1,9,1,1,9,1,1,9,9,9,9,1,9,1,9,9,9,9,9,1,1
,9,9,1,1,0,8,9,8,1,9,1,9,1,9,1,9,9,9,1,9,9,9,9,9,9,9,9,9,9,9,9,8
,9,9,1,1,9,1,9,9,0,9,9,1,8,9,9,9,1,8,9,9,1,9,9,1,9,9,9,1,9,1,9,9
,9,9,9,1,0,9,9,9,9,9,9,1,9,9,1,8,9,9,9,9,1,1,9,9,1,9,8,9,9,1,9,9
,1,1,1,9,9,1,9,9,9,1,1,9,9,9,9,9,1,1,1,1,9,9,1,1,9,9,1,9,9,1,1,9
,9,1,1,9,1,9,1,9,1,1,9,9,9,9,1,9,9,9,1,9,9,9,9,9,9,9,9,9,9,9,9,1
,9,1,9,1,9,9,9,1,9,1,1,1,1,9,9,9,9,9,9,9,1,1,1,9,1,9,1,9,9,9,1,9
,1,9,1,9,9,1,9,9,1,9,1,9,1,1,1,1,1,9,1,9,9,9,1,1,9,9,1,9,9,1,9,1
,9,1,1,1,9,1,1,9,1,1,9,9,1,1,1,1,9,9,9,9,1,9,9,1,1,9,9,9,9,1,1,1
,1,1,1,9,1,9,1,1,1,9,1,1,1,9,9,9,1,9,1,9,1,1,1,9,9,9,1,1,1,1,9,9
,1,1,1,1,9,9,1,1,1,1,1,9,1,1,9,1,1,1,9,1,9,1,9,1,1,1,1,1,1,9,9,1
,1,1,1,9,1,1,9,9,1,1,9,1,1,9,9,1,9,9,9,9,1,1,1,9,1,9,9,9,1,9,1,1
,9,1,1,9,9,1,1,1,9,1,1,9,9,9,1,9,1,1,9,1,1,9,1,1,9,9,9,1,9,1,1,1
,9,9,1,9,1,9,1,9,1,9,9,9,1,9,9,1,9,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9
,9,9,1,8,9,1,1,1,1,9,9,1,1,9,1,1,8,9,9,9,1,1,9,1,9,9,9,1,8,9,9,1
,8,1,1,1,9,9,9,9,1,9,1,8,1,9,1,9,1,1,9,9,9,9,1,8,9,1,1,9,1,1,9,9
,9,9,9,1,9,0,9,9,9,1,9,9,1,1,1,0,1,9,9,1,9,9,9,9,9,9,9,1,9,1,1,0
,9,0,1,8,1,9,1,1,1,9,9,9,9,1,0,9,9,1,1,1,8,9,9,9,1,8,9,9,9,1,9,1
,1,9,9,1,1,9,1,9,9,9,9,9,9,0,8,9,9,1,9,9,9,9,9,9,8,9,9,9,1,9,1,9
,0,9,9,1,9,9,9,9,8,1,9,9,9,1,8,1,9,1,9,1,9,9,9,9,9,9,9,9,9,9,9,9
,9,9,8,1,1,9,9,9,9,1,9,1,1,9,1,1,1,8,1,9,1,9,9,1,9,9,0,9,9,9,1,1
,1,1,9,9,1,1,9,8,9,1,1,1,9,9,9,1,9,9,9,9,9,1,9,9,9,9,9,9,9,9,9,9
,9,9,9,9,1,1,9,9,9,9,1,1,1,9,1,1,1,1,1,9,9,9,1,9,9,9,9,9,9,9,1,1
,9,9,9,1,9,1,9,9,9,1,9,9,1,9,9,1,9,9,9,9,1,9,1,9,9,1,1,1,1,1,9,9
,1,9,1,1,1,1,1,1,1,9,1,9,1,1,9,1,9,9,1,9,9,1,9,1,9,9,1,9,9,9,9,9
,1,9,1,9,1,1,9,1,9,9,1,1,9,1,9,9,1,9,9,1,9,1,1,1,1,1,1,1,9,1,1,1
   
   </textarea></td><td><input id="myButtonData" type="button" value="Load Data" onclick="{ 
   myLoadData()                                                                             
    }"> <input id="myButtonLabel" type="button" value="Add Data as an Image" onclick="{ 
    
       const numLines = prompt('y=Target for this image. 0 = No Defined Shape, 1 = Circles, 2 = Triangles, 3 = Rectangles', 1);                                                                                             
      document.getElementById('myY').value  += '\n\n\n'    // move down 3 lines for y target 
      if  (numLines == 0 ){ document.getElementById('myY').value  += ',1,0,0,0'  }    
      if  (numLines == 1 ){ document.getElementById('myY').value  += ',0,1,0,0'  }   
      if  (numLines == 2 ){ document.getElementById('myY').value  += ',0,0,1,0'  }   
      if  (numLines == 3 ){ document.getElementById('myY').value  += ',0,0,0,1'  } 
    
     const myFileName = prompt('Enter the URL of your stored data', 'https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-9.jpg');
     if (myFileName.split(',').length >= 2 ){alert('Use multi-image load above')} else {
         myLoadImage(myFileName) 
     }
}"> </td></tr>
  <tr><td>yTrainingTarget:</td><td><textarea id="myY" rows=20 cols=100% NOWRAP  placeHolder="">
0,1,0,0,
   
   
0,1,0,0,
   
   
0,1,0,0,
   
   
0,1,0,0, 
   
   
0,1,0,0, 
   
   
0,1,0,0,
   
   
1,0,0,0,
   
   
1,0,0,0
   
 </textarea></td><td><input id="myButtonLabel" type="button" value="Load Target" onclick="{ 
   myLoadTarget()                                                                             
}">  </td></tr>
  </table><br>
Remember:<br>
  
0=white, 1=black, 2-->8 = ROY-G-BIV, 9=brown <br><br>
 
<canvas id="myCanvas" width="100" height="100" style="border: 1px solid #ddd; image-rendering: pixelated; interpolation-mode: nearest-neighbor;  "></canvas> 
<br><br><br>



<h3>Compile or Load Model:</h3>
<table border=1>
  <tr><td>Compile, Train, Test: </td><td><input id="myButtonAll" type="button" value="Run All" onclick="{
     myRunAll()
  }"></td><td><input id="myButtonReset" type="button" value="Reset Buttons" onclick="{
     myResetButtons()
  }"></td><td colSpan=2>Import / Export</td><tr>
  <tr><td>Compile Model: </td><td><input id="myButtonCompile" type="button" value="Compile" onclick="{
     myCompile()
  
  }"><td></td></td><td>
<input id="myButtonLoad" type="button" value="Load From Localstorage" onclick="{ 
   myLoadLocal()                                                                             
}"> </td><td> <input id="myButtonLoad" type="button" value="Load From URL" onclick="{ 
   myLoadUrl()                                                                             
}"> </td><tr>
  
  
  <tr><td>Train Model: </td><td>
<input id="myButtonTrain" type="button" value="Train" title="toggle: start/stop" onclick="{ 
   myTrain()                                                                             
}"> </td><td>Epochs run: <input type=text id="myLastEpoch" size=6 readonly value=0> </td><td>
<input id="myButtonSave" type="button" value="Save to Localstorage" onclick="{ 
   mySaveLocal()                                                                             
}"></td><td> <input id="myButtonSave" type="button" value="Save to Disk" onclick="{ 
   mySaveDisk()                                                                             
}">  </td><tr>
  <tr><td>Test Trained Model with New Data: </td><td><input id="myButtonTest" type="button" value="Test" onclick="{
   myTest()
    }"> New Data:</td><td  colSpan=2><textarea id="myAsk" rows=40 cols=100% NOWRAP placeholder="">
 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,7,7,7,7,2,2,2,2,2,2,2,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7
,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,7,7,7,7,7,7,7,7,2,2,2,2,2,2,7
,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7
,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7
,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7
,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,7,7,7,7,7,7,7,7,2,2,2,2,2,2,7
,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7,7,7,7,2,2,2,2,2,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,7,7,7,7,2,2,2,2,2,2,2,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,2,7,7,7,7,7,7,7,7
,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
</textarea></td><td> <input id="myButtonLabel" type="button" value="Add Image to test" onclick="{ 
   myLoadTestImage()  
                                                                        
}">  <input type=button value="Show Data" onclick="myDrawTestImage()"><br>Shape: <input type="text" id="myShape" Title="Define the shape of your testing data" value="1, 32, 32, 1" placeHolder="1, 32, 32, 1"></td><tr>
</table><br>

<div id="myDivDataImage" style="border: 1px solid; display: inline-block;background-color: Gainsboro;">...</div><br>
<div id="myDivDataImage2" style="border: 1px solid; display: inline-block;">...</div><br>



<div id="myDivLoss">...</div><br>
<div id="myDivTest">...</div><br>

<div id="myDivSummary">...</div><br><br>


 

 <!-- ************* Next we define the Javascript inside a web element so that the page can be refreshed dynamically **************-->
 
 <!--  ************* The entire next line can be replaced with the <script> tag for a more conventional approch. ****************** -->

<style id="myButton124"  onload="{document.getElementById('myButton124').click()}"  onclick="{
                                                                                             
  document.getElementById('myDiv124').innerHTML = 'This version of Tensorflowjs = ' + tf.version.tfjs   
                                                                      

 class EarlyStoppingCallback extends tf.Callback {
      async onEpochEnd(epoch, logs) {     
         document.getElementById('myLastEpoch').value = epoch + 1      
         if (epoch % 20 == 0){
            // console.log('Epoch:' + epoch + ', loss:' + logs.loss)                                                                      
         }  
         if (document.stopRequested) {                                                                  
            this.model.stopTraining = true;                                                                                                                                             
        }
        document.getElementById('myDivLoss').innerHTML  = 'Epoch: ' + (parseInt(epoch) + 1) + '/'+document.getElementById('myEpoch').value + '<br>'
        document.getElementById('myDivLoss').innerHTML += 'Training loss: ' + logs.loss + '<br>'  //logs.acc, logs.val_loss, logs.val_acc
        await tf.nextFrame();  // This improves UI responsiveness during training.                                                                                                                                                                      
     }
   } 


myResetButtons = function(){ 
     tf.disposeVariables()                                                                       
     document.getElementById('myButtonAll').style.backgroundColor = 'lightGray'
     document.getElementById('myButtonCompile').style.backgroundColor = 'lightGray'
     document.getElementById('myButtonTrain').style.backgroundColor = 'lightGray'
     document.getElementById('myButtonTest').style.backgroundColor = 'lightGray'
     document.getElementById('myDivLoss').innerHTML = ''
     document.getElementById('myDivTest').innerHTML = ''
     document.getElementById('myDivSummary').innerHTML = ''
                                                                                             
}

myLoadData = async function(){
 const myFileName = prompt('Enter the URL of your stored data', 'https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/random01data.txt');
 if (myFileName != null){  
   const myData = await fetch(myFileName)
   document.getElementById('myX').value = await myData.text() 
 }                                                                           
}

 myLoadTarget = async function(){
  const myFileName = prompt('Enter the URL of your stored data', 'https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/random01target.txt');
  if (myFileName != null){                                                                            
    const myTarget = await fetch(myFileName) 
    document.getElementById('myY').value = await myTarget.text() 
  }                                                                          
}

                                                                                             
////////////////////////////////////////// START LOAD IMAGE ///////////////////////////////////////////////////////////      
                                                                                             
///////////////////// As soon as you start using real images the coding gets much more complex
///////////////////// Mainly because each pixel of colour is 4 data points Red, Green, Blue and Alpha  
///////////////////// Where Alpha is the amount of transparency  
                                                                                             
                                                                                             
 myMultiLoadImage = async function(){                                                                                           
   // alert(document.getElementById('mySelectMultiTarget').value + ', '+ document.getElementById('myMultiURL').value)

                                                                                                                                                                                         
   const mySplit =  document.getElementById('myMultiURL').value.split(',')                                                                                         
   for (var myCount = 0; myCount <= mySplit.length-1 ; myCount++ ){                                                                                         
      document.getElementById('myY').value  += '\n\n\n'    // move down 3 lines for y target                                                                                              
      document.getElementById('myY').value  += document.getElementById('mySelectMultiTarget').value                                                                                                                                                                                
         //alert(myCount + ', ' + mySplit[myCount] )
      myLoadImage(mySplit[myCount])                                                                                      
   }                                                                                          
                                                                                             
                                                                                             
 }   // end myMultiLoadImage async function 
                                                                                             
                                                                                             
                                                                                             
                                                                                             
 myLoadImage = async function(myFileName){ 
// document.getElementById('myX').value  += '\n\n'    // move down 2 lines for x data                                                                                             
                                                                                            
 if (myFileName != null){  
 // document.getElementById('myX').value  += '\n\n'    // move down 2 lines for x data                                                                                                 
  var img = new Image();
  img.src = myFileName
  var canvas = document.getElementById('myCanvas');
                                                     
  var ctx = canvas.getContext('2d');                                                                                                                                    

////////////////////////////////////////  trick to make the image pixelated when scaled   //////////////////////////////////                                                                                             
  ctx.imageSmoothingEnabled       = false;
  ctx.webkitImageSmoothingEnabled = false;
  ctx.mozImageSmoothingEnabled    = false;
  ctx.msImageSmoothingEnabled     = false;
  ctx.oImageSmoothingEnabled      = false;                                                                                            
                                                                                             
                                                                                             
 img.onload = function() {
  
  document.getElementById('myX').value  += '\n\n'    // move down 2 lines for x data                                                                                                                                                                                               
  ctx.drawImage(img, 0, 0, document.getElementById('myModelWidth').value, document.getElementById('myModelHeight').value);                                      
                 
  var imageData = ctx.getImageData(0, 0, document.getElementById('myModelWidth').value, document.getElementById('myModelHeight').value);
  var data = imageData.data;  

  var myNumCols =  data.length / (document.getElementById('myModelWidth').value * 4)        
  var myNumRows =  data.length / (document.getElementById('myModelHeight').value * 4)             
 // var myMonoChromePixels = (myNumCols + myNumRows) * 2   // for a 4 x 4 image, new data row every 16 bits of data
  var myMonoChromePixels = (myNumRows) * 4   // gets the actual number of simplified pixels per row


console.log('data.length  ' + data.length)
console.log('myNumCols ' + myNumCols)
console.log('myNumRows ' + myNumRows)
console.log('myMonoChromePixels  ' + myMonoChromePixels)


    for (var i = 0; i < data.length; i += 4) {
      var avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
      data[i]     = avg; // red
      data[i + 1] = avg; // green
      data[i + 2] = avg; // blue
      if (i % myMonoChromePixels == 0){       // finds the end of each line for monochrome picture adding 
         document.getElementById('myX').value  += '\n'                                                                                     
      }     
       const myImageNumber = findClosestColorRGB(data[i + 0], data[i + 1], data[i + 2], ColorTable)  
                                                                                             
       document.getElementById('myX').value  += ',' + myImageNumber                                                                                    
                                                                                             
    /*                                                                                         
      if (avg >= 150) {
        document.getElementById('myX').value  += ',0'    // white randomly set for any average value over or equal to 150                                                                                  
         } else {
        document.getElementById('myX').value  += ',1'    // black randomly set for any average value under 150                                                                                      
      } 
                                                                                             
    */                                                                                         
                                                                                             
                                                                                             
    }  // end for loop
   // console.log(data) 
                                                                                             
   //ctx.rect(20,20,150,100);
   //ctx.stroke();                                                                                          
                                                                                                                              
                                                                                             
                                                                                             
                                                                                             
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  // img.style.display = 'none';
  img.style.display = 'inline';
  
                                                                                             
  /*                                                                                           
  setTimeout(function(){                                                                                         
      const numLines = prompt('y=Target for this image. 0 = No Defined Shape, 1 = Circles, 2 = Triangles, 3 = Rectangles', 1);                                                                                             
      document.getElementById('myY').value  += '\n\n\n'    // move down 3 lines for y target 
      if  (numLines == 0 ){ document.getElementById('myY').value  += ',1,0,0,0'  }    
      if  (numLines == 1 ){ document.getElementById('myY').value  += ',0,1,0,0'  }   
      if  (numLines == 2 ){ document.getElementById('myY').value  += ',0,0,1,0'  }   
      if  (numLines == 3 ){ document.getElementById('myY').value  += ',0,0,0,1'  }   
   }, 50);    // give the image some time to load. Should use Async, but was lazy today                                                                                           
                                                                                             
    */                                                                                         
                                                                                             
                                                                                             
  }
                                                                                             
   } // end if  array                                                                                  
 // } // end if  null                                                                       
}

 myLoadTestImage = async function(){ 
                                                                                             
                                                                                             
 document.getElementById('myAsk').value  = ''    // blank the old test                                                                                          
 const myFileName = prompt('Enter the URL of your stored data', 'https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/saved-models/soccer/soccer-ball-9.jpg');
 if (myFileName.split(',').length >= 2 ){alert('Not ready to load multiple images')} else {
                                                                                             
 if (myFileName != null){  
                                                                                             
  var img = new Image();
  img.src = myFileName
  var canvas = document.getElementById('myCanvas');
                                                     
  var ctx = canvas.getContext('2d');                                                                                                                                    

////////////////////////////////////////  trick to make the image pixelated when scaled   //////////////////////////////////                                                                                             
  ctx.imageSmoothingEnabled       = false;
  ctx.webkitImageSmoothingEnabled = false;
  ctx.mozImageSmoothingEnabled    = false;
  ctx.msImageSmoothingEnabled     = false;
  ctx.oImageSmoothingEnabled      = false;                                                                                            
                                                                                             
                                                                                             
 img.onload = function() {
                                                                                                                                                                                          
  ctx.drawImage(img, 0, 0, document.getElementById('myModelWidth').value, document.getElementById('myModelHeight').value);                                      
                 
  var imageData = ctx.getImageData(0, 0, document.getElementById('myModelWidth').value, document.getElementById('myModelHeight').value);
  var data = imageData.data;  

  var myNumCols =  data.length / (document.getElementById('myModelWidth').value * 4)        
  var myNumRows =  data.length / (document.getElementById('myModelHeight').value * 4)             
 // var myMonoChromePixels = (myNumCols + myNumRows) * 2   // for a 4 x 4 image, new data row every 16 bits of data
  var myMonoChromePixels = (myNumRows) * 4   // gets the actual number of simplified pixels per row


console.log('data.length  ' + data.length)
console.log('myNumCols ' + myNumCols)
console.log('myNumRows ' + myNumRows)
console.log('myMonoChromePixels  ' + myMonoChromePixels)


    for (var i = 0; i < data.length; i += 4) {
      var avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
      data[i]     = avg; // red
      data[i + 1] = avg; // green
      data[i + 2] = avg; // blue
      if (i % myMonoChromePixels == 0){       // finds the end of each line for monochrome picture adding 
         document.getElementById('myAsk').value  += '\n'                                                                                     
      }     
       const myImageNumber = findClosestColorRGB(data[i + 0], data[i + 1], data[i + 2], ColorTable)  
       if (i==0){
          document.getElementById('myAsk').value  += ' ' + myImageNumber 
        }  else {                                                                                    
          document.getElementById('myAsk').value  += ',' + myImageNumber 
       }                                                                                      
                                                                                             
    /*                                                                                         
      if (avg >= 150) {
        document.getElementById('myAsk').value  += ',0'    // white randomly set for any average value over or equal to 150                                                                                  
         } else {
        document.getElementById('myAsk').value  += ',1'    // black randomly set for any average value under 150                                                                                      
      } 
                                                                                             
    */                                                                                         
                                                                                             
                                                                                             
    }  // end for loop
   // console.log(data) 
                                                                                             
   //ctx.rect(20,20,150,100);
   //ctx.stroke();                                                                                          
                                                                                                                              
                                                                                             
                                                                                             
                                                                                             
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
  // img.style.display = 'none';
  img.style.display = 'inline';
                                                                                       
                                                                                             
                                                                                             
                                                                                             
                                                                                             
  }
                                                                                             
   } // end if  array                                                                                  
  } // end if  null  
                                                                                             
   setTimeout(function(){                                                                                         
       myDrawTestImage()    // might as well show the image on the page.    
   }, 500);                 // give the image some time to load. Should use Async, but was lazy today 
                                                                                             
setTimeout(function(){                                                                                         
       myTest()              // While we are at it we should probably test the data    
   }, 500);                 // give the image some time to load. Should use Async, but was lazy today  
                                                                                                                                                                                    
}


                                                                                             
                                                                                             
myDrawTestImage = async function(){
 // var canvas5 = document.getElementById('myCanvas');                                                
 // var ctx5 = canvas5.getContext('2d');  
 // var imageData5 = ctx5.getImageData(0, 0, document.getElementById('myModelWidth').value, document.getElementById('myModelHeight').value);
  //var data = imageData5.data;  
 //alert(  ColorTable[document.getElementById('myAsk').value.split(',')[0]].hex   )
// alert(     document.getElementById('myAsk').value)
  
                                                                                           
    
  document.getElementById('myDivDataImage').innerHTML =''   
  document.getElementById('myDivDataImage2').innerHTML =''     
                                                                                             
 const myIncomingArray =  document.getElementById('myAsk').value.split(',')                                                                                           
 for (var myWow=0; myWow <= myIncomingArray.length-1 ; myWow++){
   // alert(ColorTable[myIncomingArray[myWow]].hex)
    //  alert(parseInt(myIncomingArray[myWow]))
    if ((myWow >= 1) && (myWow % parseInt(document.getElementById('myModelWidth').value) == 0)){
      document.getElementById('myDivDataImage').innerHTML += '<br>'                 
      document.getElementById('myDivDataImage2').innerHTML += '<br>'                                                                                       
   } 
   document.getElementById('myDivDataImage').innerHTML +=  '<font color='+ColorTable[parseInt(myIncomingArray[myWow])].hex+'>'+  myIncomingArray[myWow]    + '</font>'                                                                                     
   document.getElementById('myDivDataImage2').innerHTML +=  '<font color='+ColorTable[parseInt(myIncomingArray[myWow])].hex+'></font>'                                                                                     
                                                                                        
                                                                                             
 }                                                                                            
      
                                                                                             
                                                                                           
                                                                                             
                                                                                             
 }                                                                                             
                                                                                             
                                                                                             
                                                                                             
////////////////////////////////////////// END LOAD IMAGE ///////////////////////////////////////////////////////////  
                                                                                             
                                                                                             
                                                                                             
                                                                                             
 myRunAll = async function(){
  document.getElementById('myButtonAll').style.backgroundColor = 'yellow'
  await myCompile()
  await myTrain()
  await myTest()
}

 myCompile = async function(){
    document.getElementById('myLastEpoch').value = 0   // reset initialEpoch   
                                                                                             

     /////////////////////////////////// DEFINE THE MODEL /////////////////////////////////////////////////////////                                                                                                 
                                                                                             
                                                                                             
    model = tf.sequential(); // no const so that it is a global variable 
                                                                                                                                                                        
    model.add(tf.layers.conv2d({                                                                                                                                            
        inputShape: [32, 32, 1],                                                                                                                                                  
        kernelSize: 2,                                                                                                                                                          
        filters: 4,                                                                                                                                                             
        strides: 8,                                                                                                                                                             
        activation: 'relu',                                                                                                                                                     
        kernelInitializer: 'varianceScaling'                                                                                                                                    
    }));                                                                                                                                                                    
                                                                                                                                                                        
    model.add(tf.layers.conv2d({ kernelSize: 2, filters: 4, strides: 8, activation: 'relu', kernelInitializer: 'varianceScaling' }));                                                                                                                                                                                                               
    model.add(tf.layers.flatten());                                                                                                                                         
    model.add(tf.layers.dense({ units: 30, kernelInitializer: 'varianceScaling', activation: 'softmax' }));                                                                 
    model.add(tf.layers.dense({ units: 4, activation: 'linear' }) ); 
                                          


    const myLearningRate = Number.parseFloat(document.getElementById('myLearn').value)     
    const myOptimizer = tf.train.sgd(myLearningRate);               
    model.compile({optimizer: myOptimizer, loss: 'meanSquaredError'});                 
    console.log(model)
    document.getElementById('myDivSummary').innerHTML = ''                                                                        
    await model.summary(null,null,x => {document.getElementById('myDivSummary').innerHTML += x + '<br>'});
    document.getElementById('myButtonCompile').style.backgroundColor = 'yellow'
}

 myTrain = async function(){  
   if (document.getElementById('myLastEpoch').value == document.getElementById('myEpoch').value) {
      alert('Already completed all epochs. To continue training, increase \'Epochs: (# of batches to run)\' and re-click this button')                                                                        
   }                                                                         
   if(document.getElementById('myButtonTrain').style.backgroundColor == 'red'){
       document.getElementById('myButtonTrain').style.backgroundColor = 'yellow'
       document.getElementById('myButtonTrain').value = 'Continue Training'
       document.stopRequested = true     
        // document.getElementById('myArea').value  +=   JSON.stringify(model, null, 4)                                                
   }    else {     
         document.stopRequested = false
         document.getElementById('myButtonTrain').style.backgroundColor = 'red'                                                                           
         document.getElementById('myButtonTrain').value = 'Pause Training'
  }
                                                               
     /////////////////////////////////// PREPARE DATA /////////////////////////////////////////////////////////    
   let xArray = document.getElementById('myX').value.split(',')
   let yArray = document.getElementById('myY').value.split(',')   
                                                                                   
   const xTrainingData   = tf.tensor4d(xArray, shape=[xArray.length/1024, 32, 32, 1]);
   const yTrainingTarget = tf.tensor2d(yArray, shape=[yArray.length/4, 4]);
                                           
   // console.log(xTrainingData)
   // console.log(yTrainingTarget) 
                                                                                                                                         
   /////////////////////////////////// TRAIN MODEL /////////////////////////////////////////////////////////  
                                                                    
   // xTrainingData.print()    // have a look at the training tensor in the console                                                                             
   // yTrainingTarget.print()
                                                                                                 
   console.log('Starting Training')               
   var myFit = await model.fit(xTrainingData, yTrainingTarget, {
        batchSize : Number.parseInt(document.getElementById('myBatch').value),                                                             epochs    : Number.parseInt(document.getElementById('myEpoch').value),  
        validationSplit: Number.parseFloat(document.getElementById('myValidationSplit').value),   // for seperating percent of data for testing  0.15 = 15% for testin  
        initialEpoch : Number.parseInt(document.getElementById('myLastEpoch').value),             // for restarting training                                                                       
        callbacks:  new EarlyStoppingCallback(),  
          onBatchEnd: async (batch, logs) => {                                                               
               await tf.nextFrame();  // This improves UI responsiveness during training.  
          }      // end all callbacks                                                              
      })          // end model.fit              
     console.log(myFit.history)                                                                          
     document.getElementById('myButtonTrain').style.backgroundColor = 'yellow'                                                                              
     document.getElementById('myButtonTrain').value = 'Continue Training'
                                                                           
}

myTest = async function(){
 
    const myShape = document.getElementById('myShape').value.split(',').map(Number);
  
    // draw the input shape
    myDrawTestImage()
    
    // show the results                                                                                         
    const myPredictArray = await model.predict(tf.tensor4d(document.getElementById('myAsk').value.split(','), myShape)).data()                                                                                                                                      
   // document.getElementById('myDivTest').innerHTML = 'Input :<br>'+document.getElementById('myAsk').value+'<br><br> Output = <br>'                                                                                                                               
    document.getElementById('myDivTest').innerHTML = ' Output = <br>'
    document.getElementById('myDivTest').innerHTML += '<b>0 No Shape ' + await Math.round(myPredictArray[0]*100) +'%</b><br>'          
    document.getElementById('myDivTest').innerHTML += '<b>1 Circle ' + await Math.round(myPredictArray[1]*100) +'%</b><br>'        
    document.getElementById('myDivTest').innerHTML += '<b>2 Triangle ' + await Math.round(myPredictArray[2]*100) +'%</b><br>'        
    document.getElementById('myDivTest').innerHTML += '<b>3 Rectangle ' + await Math.round(myPredictArray[3]*100) +'%</b><br>'      
                                                                                             
  console.log(document.getElementById('myAsk2').value + ': ' + await myPredictArray) 
  document.getElementById('myButtonTest').style.backgroundColor = 'yellow'
}


myLoadLocal = async function(){
  alert('The test function will need to be changed if other models are loaded')
  const myFileName = prompt('Enter stored base filename. ctrl-shift-i in browser, then Applications, localstorage', 'localstorage://26keras-small-image');
  if (myFileName != null){  
    model = await tf.loadModel(myFileName); 
    document.getElementById('myDivSummary').innerHTML = ''     
    await model.summary(null,null,x => {document.getElementById('myDivSummary').innerHTML += x + '<br>'});
    await myTest()
  }                                                                          
}

 myLoadUrl = async function(){
  alert('The test function will need to be changed if other models are loaded')
  const myFileName = prompt('Enter URL of stored model', '');
  if (myFileName != null){  
    model = await tf.loadModel(myFileName);
    document.getElementById('myDivSummary').innerHTML = ''      
    await model.summary(null,null,x => {document.getElementById('myDivSummary').innerHTML += x + '<br>'});
    await myTest()
  }                                                                           
}


 mySaveLocal = async function(){
  const myFileName = prompt('Enter filename to store this model','localstorage://26keras-small-image');
  const saveResults = await model.save(myFileName);
  document.getElementById('myDivSummary').innerHTML = ''    
  model.summary()
}

 mySaveDisk = async function(){
  alert('make a new folder on your computer, save the model (both bin and json extensions) to the folder, then upload the folder to a website')
  const myFileName = prompt('Enter filename to store this model','downloads://26keras-small-image');
  const saveResults = await model.save(myFileName);
  document.getElementById('myDivSummary').innerHTML = ''    
  model.summary()
}

                                                                                             
                                                                                             
                                                                                             

/////////////////////////////////////////// START REDUCING RGB CODES TO SINGLE DIGIT ////////////////////////////////////
                                                                                             


                                                                                           
                                                                                             

var ColorTable = [
{name:'white', hex: '#FFFFFF'},    // 0 white
{name:'black', hex: '#000000'},    // 1 black
{name:'red', hex: '#FF0000'},      // 2 red
{name:'orange', hex: '#FFA500'},   // 3 orange
{name:'yellow', hex: '#FFFF00'},   // 4 yellow
{name:'green', hex: '#008000'},    // 5 green
{name:'blue', hex: '#0000FF'},     // 6 blue
{name:'indigo', hex: '#4B0082'},   // 7 indigo
{name:'violet', hex: '#008080'},   // 8 violet
{name:'brown', hex: '#8B4513'}     // 9 brown
];

 

  
  
  
function rgbToHex(r, g, b) {
    return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}
  
  
  
  





Hex2RGB = function(hex) {
    if (hex.lastIndexOf('#') > -1) {
        hex = hex.replace(/#/, '0x');
    } else {
        hex = '0x' + hex;
    }
    var r = hex >> 16;
    var g = (hex & 0x00FF00) >> 8;
    var b = hex & 0x0000FF;
    return {r:r, g:g, b:b};
};


function findClosestColorRGB(r, g, b, table)
{
  var rgb = {r:r, g:g, b:b};
  var delta = 3 * 256*256;
  var temp = {r:0, g:0, b:0};
  var nameFound = 'black';
  
  for(i=0; i<table.length; i++)
  {
  	temp = Hex2RGB(table[i].hex);
    if(Math.pow(temp.r-rgb.r,2) + Math.pow(temp.g-rgb.g,2) + Math.pow(temp.b-rgb.b,2) < delta)
    {
    	delta = Math.pow(temp.r-rgb.r,2) + Math.pow(temp.g-rgb.g,2) + Math.pow(temp.b-rgb.b,2);
     // nameFound = [table[i].name, i]; //  fancy array return
      nameFound =  i;                  // just return the number
    }
  }
  return nameFound;
}
                                                                                             
                                                                                             
                                                                                             
                                                                                             

/////////////////////////////////////////// END REDUCING RGB CODES TO SINGLE DIGIT ////////////////////////////////////                                                                                               
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             

}"></style>
<!-- If you replaced the <style> tag with a <script> tag don't forget to change the above line to just </script>  -->
                                                                 

</div>
<div id='myDiv124'>...</div><br>

<input id="myUpdate124" type=button value="Update and Run" style="visibility:hidden;" onclick="{

   // first remove first and last line since they are injected
  myFred = document.getElementById('myTextarea124').value.split('\n')
  myFred.pop()
  myFred.push('')
  myFred.shift()
  myFred.shift()
  myJoe = myFred.join('\n')

  document.getElementById('myDiv124Code').innerHTML =    myJoe 
  document.getElementById('myButton124').click()
                                             
}"><br>

<textarea id="myTextarea124"  wrap="off"  style= "font-size:15px; color:white; background-color:black; width:90%;"   rows=2 onclick="{
  if (myOnce124){
     myTextGrow('myTextarea124', 'myDiv124Code')
     document.getElementById('myUpdate124').style.visibility = 'visible'
     myOnce124 = false
  }
}">
Click here to see the working HTML code.
</textarea><br>





<br><br><br><hr><br><br><br><br>



















This <a href="https://github.com/hpssjellis/beginner-tensorflowjs-examples-in-javascript">Github</a>, ...  
this <a href="https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/">Github Website Version</a>, ... 
this <a href="http://rocksetta.com/tensorflowjs/">Hosted Website Version</a>, ... 
<a href="https://js.tensorflow.org/">Tensorflowjs</a> <br> <br>



By Jeremy Ellis <br>
Twitter<a href="https://twitter.com/@rocksetta">@rocksetta</a><br>
Website <a href="http://rocksetta.com">http://rocksetta.com</a><br>
Use at your own risk!
    
    
    


 
 
 

<!--  Following is a helper functions  to grow the textareas  -->

<script>

myOnce7979 = true    // so textareas are only clicked once
myOnce124 = true  

function myTextGrow(myT, myB){
   var myCursorStart = document.getElementById(myT).selectionStart
   var myCursorEnd = document.getElementById(myT).selectionEnd

   myDivName = myB.replace('Code','')
   document.getElementById(myT).value = '\x3Cscript src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.4"> \x3C/script> \n\n' + document.getElementById(myB).innerHTML 
   document.getElementById(myT).value += '<div id=\''+myDivName+'\'>...</div><br>'     
   setTimeout(function() {
      while (  document.getElementById(myT).clientHeight < document.getElementById(myT).scrollHeight){                                                                                                                                               
          document.getElementById(myT).rows += 3; 
      } 
   }, 100)

  document.getElementById(myT).selectionStart = myCursorStart
  document.getElementById(myT).selectionEnd = myCursorEnd

}  


</script>  
 
 
</body>
